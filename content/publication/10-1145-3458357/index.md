---
title: "Flynn’s Reconciliation: Automating the Register Cache Idiom for Cross-Accelerator Programming"
date: 2021-06-01
publishDate: 2021-08-09T18:20:57.910001Z
authors: ["Daniel Thuerck", "Nicolas Weber", "Roberto Bifulco"]
publication_types: ["2"]
abstract: "A large portion of the recent performance increase in the High Performance Computing (HPC) and Machine Learning (ML) domains is fueled by accelerator cards. Many popular ML frameworks support accelerators by organizing computations as a computational graph over a set of highly optimized, batched general-purpose kernels. While this approach simplifies the kernels’ implementation for each individual accelerator, the increasing heterogeneity among accelerator architectures for HPC complicates the creation of portable and extensible libraries of such kernels. Therefore, using a generalization of the CUDA community’s warp register cache programming idiom, we propose a new programming idiom (CoRe) and a virtual architecture model (PIRCH), abstracting over SIMD and SIMT paradigms. We define and automate the mapping process from a single source to PIRCH’s intermediate representation and develop backends that issue code for three different architectures: Intel AVX512, NVIDIA GPUs, and NEC SX-Aurora. Code generated by our source-to-source compiler for batched kernels, borG, competes favorably with vendor-tuned libraries and is up to 2× faster than hand-tuned kernels across architectures."
featured: false
publication: "*ACM Transactions on Architecture and Code Optimization (ACM TACO)*"
tags: ["cross-architecture compilation", "SIMD", "warp-register cache", "Accelerated computing", "batched kernels", "GPGPU", "SIMT", "source-to-source compiler"]
url_pdf: "https://doi.org/10.1145/3458357"
doi: "10.1145/3458357"
---

